{"version":3,"file":"scaleSkew.mjs","sources":["../../../src/controls/scaleSkew.ts"],"sourcesContent":["import type {\n  ControlCallback,\n  ControlCursorCallback,\n  TPointerEvent,\n  TransformActionHandler,\n} from '../EventTypeDefs';\nimport type { FabricObject } from '../shapes/Object/FabricObject';\nimport type { TAxisKey } from '../typedefs';\nimport { scaleCursorStyleHandler, scalingX, scalingY } from './scale';\nimport { skewCursorStyleHandler, skewHandlerX, skewHandlerY } from './skew';\n\nfunction isAltAction(eventData: TPointerEvent, target: FabricObject) {\n  return eventData[target.canvas!.altActionKey!];\n}\n\n/**\n * Inspect event, control and fabricObject to return the correct action name\n * @param {Event} eventData the javascript event that is causing the scale\n * @param {Control} control the control that is interested in the action\n * @param {FabricObject} fabricObject the fabric object that is interested in the action\n * @return {String} an action name\n */\nexport const scaleOrSkewActionName: ControlCallback<\n  TAxisKey<'skew' | 'scale'> | ''\n> = (eventData, control, fabricObject) => {\n  const isAlternative = isAltAction(eventData, fabricObject);\n  if (control.x === 0) {\n    // then is scaleY or skewX\n    return isAlternative ? 'skewX' : 'scaleY';\n  }\n  if (control.y === 0) {\n    // then is scaleY or skewX\n    return isAlternative ? 'skewY' : 'scaleX';\n  }\n  return '';\n};\n\n/**\n * Combine skew and scale style handlers to cover fabric standard use case\n * @param {Event} eventData the javascript event that is causing the scale\n * @param {Control} control the control that is interested in the action\n * @param {FabricObject} fabricObject the fabric object that is interested in the action\n * @return {String} a valid css string for the cursor\n */\nexport const scaleSkewCursorStyleHandler: ControlCursorCallback = (\n  eventData,\n  control,\n  fabricObject\n) => {\n  return isAltAction(eventData, fabricObject)\n    ? skewCursorStyleHandler(eventData, control, fabricObject)\n    : scaleCursorStyleHandler(eventData, control, fabricObject);\n};\n/**\n * Composed action handler to either scale X or skew Y\n * Needs to be wrapped with `wrapWithFixedAnchor` to be effective\n * @param {Event} eventData javascript event that is doing the transform\n * @param {Object} transform javascript object containing a series of information around the current transform\n * @param {number} x current mouse x position, canvas normalized\n * @param {number} y current mouse y position, canvas normalized\n * @return {Boolean} true if some change happened\n */\nexport const scalingXOrSkewingY: TransformActionHandler = (\n  eventData,\n  transform,\n  x,\n  y\n) => {\n  return isAltAction(eventData, transform.target)\n    ? skewHandlerY(eventData, transform, x, y)\n    : scalingX(eventData, transform, x, y);\n};\n\n/**\n * Composed action handler to either scale Y or skew X\n * Needs to be wrapped with `wrapWithFixedAnchor` to be effective\n * @param {Event} eventData javascript event that is doing the transform\n * @param {Object} transform javascript object containing a series of information around the current transform\n * @param {number} x current mouse x position, canvas normalized\n * @param {number} y current mouse y position, canvas normalized\n * @return {Boolean} true if some change happened\n */\nexport const scalingYOrSkewingX: TransformActionHandler = (\n  eventData,\n  transform,\n  x,\n  y\n) => {\n  return isAltAction(eventData, transform.target)\n    ? skewHandlerX(eventData, transform, x, y)\n    : scalingY(eventData, transform, x, y);\n};\n"],"names":["isAltAction","eventData","target","canvas","altActionKey","scaleOrSkewActionName","control","fabricObject","isAlternative","x","y","scaleSkewCursorStyleHandler","skewCursorStyleHandler","scaleCursorStyleHandler","scalingXOrSkewingY","transform","skewHandlerY","scalingX","scalingYOrSkewingX","skewHandlerX","scalingY"],"mappings":";;;AAWA,SAASA,WAAWA,CAACC,SAAwB,EAAEC,MAAoB,EAAE;AACnE,EAAA,OAAOD,SAAS,CAACC,MAAM,CAACC,MAAM,CAAEC,YAAY,CAAE,CAAA;AAChD,CAAA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,MAAMC,qBAEZ,GAAGA,CAACJ,SAAS,EAAEK,OAAO,EAAEC,YAAY,KAAK;AACxC,EAAA,MAAMC,aAAa,GAAGR,WAAW,CAACC,SAAS,EAAEM,YAAY,CAAC,CAAA;AAC1D,EAAA,IAAID,OAAO,CAACG,CAAC,KAAK,CAAC,EAAE;AACnB;AACA,IAAA,OAAOD,aAAa,GAAG,OAAO,GAAG,QAAQ,CAAA;AAC3C,GAAA;AACA,EAAA,IAAIF,OAAO,CAACI,CAAC,KAAK,CAAC,EAAE;AACnB;AACA,IAAA,OAAOF,aAAa,GAAG,OAAO,GAAG,QAAQ,CAAA;AAC3C,GAAA;AACA,EAAA,OAAO,EAAE,CAAA;AACX,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACO,MAAMG,2BAAkD,GAAGA,CAChEV,SAAS,EACTK,OAAO,EACPC,YAAY,KACT;EACH,OAAOP,WAAW,CAACC,SAAS,EAAEM,YAAY,CAAC,GACvCK,sBAAsB,CAACX,SAAS,EAAEK,OAAO,EAAEC,YAAY,CAAC,GACxDM,uBAAuB,CAACZ,SAAS,EAAEK,OAAO,EAAEC,YAAY,CAAC,CAAA;AAC/D,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,MAAMO,kBAA0C,GAAGA,CACxDb,SAAS,EACTc,SAAS,EACTN,CAAC,EACDC,CAAC,KACE;AACH,EAAA,OAAOV,WAAW,CAACC,SAAS,EAAEc,SAAS,CAACb,MAAM,CAAC,GAC3Cc,YAAY,CAACf,SAAS,EAAEc,SAAS,EAAEN,CAAC,EAAEC,CAAC,CAAC,GACxCO,QAAQ,CAAChB,SAAS,EAAEc,SAAS,EAAEN,CAAC,EAAEC,CAAC,CAAC,CAAA;AAC1C,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,MAAMQ,kBAA0C,GAAGA,CACxDjB,SAAS,EACTc,SAAS,EACTN,CAAC,EACDC,CAAC,KACE;AACH,EAAA,OAAOV,WAAW,CAACC,SAAS,EAAEc,SAAS,CAACb,MAAM,CAAC,GAC3CiB,YAAY,CAAClB,SAAS,EAAEc,SAAS,EAAEN,CAAC,EAAEC,CAAC,CAAC,GACxCU,QAAQ,CAACnB,SAAS,EAAEc,SAAS,EAAEN,CAAC,EAAEC,CAAC,CAAC,CAAA;AAC1C;;;;"}