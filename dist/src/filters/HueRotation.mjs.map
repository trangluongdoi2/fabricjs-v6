{"version":3,"file":"HueRotation.mjs","sources":["../../../src/filters/HueRotation.ts"],"sourcesContent":["import type { TClassProperties } from '../typedefs';\nimport { cos } from '../util/misc/cos';\nimport { sin } from '../util/misc/sin';\nimport { ColorMatrix } from './ColorMatrix';\nimport type { TWebGLPipelineState, T2DPipelineState } from './typedefs';\nimport { classRegistry } from '../ClassRegistry';\n\nexport const hueRotationDefaultValues: Partial<TClassProperties<HueRotation>> =\n  {\n    rotation: 0,\n    mainParameter: 'rotation',\n  };\n\n/**\n * HueRotation filter class\n * @example\n * const filter = new HueRotation({\n *   rotation: -0.5\n * });\n * object.filters.push(filter);\n * object.applyFilters();\n */\n// @ts-expect-error some babbling about mainParameter\nexport class HueRotation extends ColorMatrix {\n  /**\n   * HueRotation value, from -1 to 1.\n   */\n  declare rotation: number;\n\n  static type = 'HueRotation';\n\n  static defaults = hueRotationDefaultValues;\n\n  calculateMatrix() {\n    const rad = this.rotation * Math.PI,\n      cosine = cos(rad),\n      sine = sin(rad),\n      aThird = 1 / 3,\n      aThirdSqtSin = Math.sqrt(aThird) * sine,\n      OneMinusCos = 1 - cosine;\n    this.matrix = [1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0];\n    this.matrix[0] = cosine + OneMinusCos / 3;\n    this.matrix[1] = aThird * OneMinusCos - aThirdSqtSin;\n    this.matrix[2] = aThird * OneMinusCos + aThirdSqtSin;\n    this.matrix[5] = aThird * OneMinusCos + aThirdSqtSin;\n    this.matrix[6] = cosine + aThird * OneMinusCos;\n    this.matrix[7] = aThird * OneMinusCos - aThirdSqtSin;\n    this.matrix[10] = aThird * OneMinusCos - aThirdSqtSin;\n    this.matrix[11] = aThird * OneMinusCos + aThirdSqtSin;\n    this.matrix[12] = cosine + aThird * OneMinusCos;\n  }\n\n  isNeutralState() {\n    this.calculateMatrix();\n    return super.isNeutralState();\n  }\n\n  applyTo(options: TWebGLPipelineState | T2DPipelineState) {\n    this.calculateMatrix();\n    super.applyTo(options);\n  }\n}\n\nclassRegistry.setClass(HueRotation);\n"],"names":["hueRotationDefaultValues","rotation","mainParameter","HueRotation","ColorMatrix","calculateMatrix","rad","Math","PI","cosine","cos","sine","sin","aThird","aThirdSqtSin","sqrt","OneMinusCos","matrix","isNeutralState","applyTo","options","_defineProperty","classRegistry","setClass"],"mappings":";;;;;;AAOO,MAAMA,wBAAgE,GAC3E;AACEC,EAAAA,QAAQ,EAAE,CAAC;AACXC,EAAAA,aAAa,EAAE,UAAA;AACjB,EAAC;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,MAAMC,WAAW,SAASC,WAAW,CAAC;AAU3CC,EAAAA,eAAeA,GAAG;IAChB,MAAMC,GAAG,GAAG,IAAI,CAACL,QAAQ,GAAGM,IAAI,CAACC,EAAE;AACjCC,MAAAA,MAAM,GAAGC,GAAG,CAACJ,GAAG,CAAC;AACjBK,MAAAA,IAAI,GAAGC,GAAG,CAACN,GAAG,CAAC;MACfO,MAAM,GAAG,CAAC,GAAG,CAAC;MACdC,YAAY,GAAGP,IAAI,CAACQ,IAAI,CAACF,MAAM,CAAC,GAAGF,IAAI;MACvCK,WAAW,GAAG,CAAC,GAAGP,MAAM,CAAA;AAC1B,IAAA,IAAI,CAACQ,MAAM,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAA;IAC1E,IAAI,CAACA,MAAM,CAAC,CAAC,CAAC,GAAGR,MAAM,GAAGO,WAAW,GAAG,CAAC,CAAA;IACzC,IAAI,CAACC,MAAM,CAAC,CAAC,CAAC,GAAGJ,MAAM,GAAGG,WAAW,GAAGF,YAAY,CAAA;IACpD,IAAI,CAACG,MAAM,CAAC,CAAC,CAAC,GAAGJ,MAAM,GAAGG,WAAW,GAAGF,YAAY,CAAA;IACpD,IAAI,CAACG,MAAM,CAAC,CAAC,CAAC,GAAGJ,MAAM,GAAGG,WAAW,GAAGF,YAAY,CAAA;IACpD,IAAI,CAACG,MAAM,CAAC,CAAC,CAAC,GAAGR,MAAM,GAAGI,MAAM,GAAGG,WAAW,CAAA;IAC9C,IAAI,CAACC,MAAM,CAAC,CAAC,CAAC,GAAGJ,MAAM,GAAGG,WAAW,GAAGF,YAAY,CAAA;IACpD,IAAI,CAACG,MAAM,CAAC,EAAE,CAAC,GAAGJ,MAAM,GAAGG,WAAW,GAAGF,YAAY,CAAA;IACrD,IAAI,CAACG,MAAM,CAAC,EAAE,CAAC,GAAGJ,MAAM,GAAGG,WAAW,GAAGF,YAAY,CAAA;IACrD,IAAI,CAACG,MAAM,CAAC,EAAE,CAAC,GAAGR,MAAM,GAAGI,MAAM,GAAGG,WAAW,CAAA;AACjD,GAAA;AAEAE,EAAAA,cAAcA,GAAG;IACf,IAAI,CAACb,eAAe,EAAE,CAAA;AACtB,IAAA,OAAO,KAAK,CAACa,cAAc,EAAE,CAAA;AAC/B,GAAA;EAEAC,OAAOA,CAACC,OAA+C,EAAE;IACvD,IAAI,CAACf,eAAe,EAAE,CAAA;AACtB,IAAA,KAAK,CAACc,OAAO,CAACC,OAAO,CAAC,CAAA;AACxB,GAAA;AACF,CAAA;AArCE;AACF;AACA;AAFEC,eAAA,CADWlB,WAAW,EAAA,MAAA,EAMR,aAAa,CAAA,CAAA;AAAAkB,eAAA,CANhBlB,WAAW,EAAA,UAAA,EAQJH,wBAAwB,CAAA,CAAA;AAgC5CsB,aAAa,CAACC,QAAQ,CAACpB,WAAW,CAAC;;;;"}